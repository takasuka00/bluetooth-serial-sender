# Bluetooth Serial Sender

Bluetoothシリアル通信でCSVファイルのデータを指定されたタイミングで送信するWindows用デスクトップアプリケーションです。

## 機能

- Bluetoothシリアルポート（COMポート）への接続
- CSVファイルの読み込み（フォーマット: time[s], data[十進数]）
- タイマーによる自動送信（CSVファイルで指定されたタイミング）
- 手動でのバイトデータ送信（10進数/16進数入力対応）
- 送信ログの表示
- プログレスバーによる進捗表示
- 送信済みデータの可視化
- ボーレート設定（1200～115200 bps）

## 必要環境

- Windows 10/11
- .NET 8.0 Runtime
- Bluetoothシリアルポートアダプター（HC-06等）

## HC-06の接続方法

1. **Windowsでのペアリング**
   - Windowsの設定 → デバイス → Bluetoothとその他のデバイス
   - 「Bluetoothまたはその他のデバイスを追加する」をクリック
   - HC-06を選択（通常「HC-06」と表示される）
   - PINコード入力画面が表示されたら「1234」または「0000」を入力
   - ペアリング完了

2. **COMポートの確認**
   - デバイスマネージャーを開く（Windowsキー＋X → デバイスマネージャー）
   - 「ポート（COMとLPT）」を展開
   - 「標準 Bluetooth シリアル通信ポート」を確認
   - 複数ある場合は「発信」ポートを使用する

3. **よくある接続トラブル**
   - **「アクセスが拒否されました」エラー**
     - 他のアプリケーションがポートを使用していないか確認
     - Arduinoシリアルモニタ等を閉じる
   - **「指定されたポートは開けません」エラー**
     - 正しいCOMポートを選択しているか確認
     - Bluetoothが有効になっているか確認
     - HC-06の電源が入っているか確認（LEDが点滅）
   - **データが送信されない**
     - ボーレートが正しいか確認（HC-06のデフォルトは9600）
     - HC-06のTXD/RXDが正しく接続されているか確認

## 使い方

1. **Bluetoothデバイスの準備**
   - HC-06をWindowsとペアリングする
   - デバイスマネージャーでCOMポート番号を確認する

2. **アプリケーションの起動**
   - BluetoothSerialSender.exeを実行する

3. **接続**
   - COMポートを選択（発信ポートを選択）
   - ボーレートを選択（HC-06のデフォルトは9600）
   - 「接続」ボタンをクリック

4. **CSVファイルの読み込み**
   - 「参照...」ボタンでCSVファイルを選択
   - 「CSV読み込み」ボタンをクリック

5. **送信**
   - 「開始」ボタンで自動送信を開始
   - 「停止」ボタンで一時停止
   - 「リセット」ボタンで最初から送信し直し

## CSVファイルフォーマット

```csv
time,data
0.02,250
0.10,128
0.20,64
```

- `time`: 送信タイミング（秒）
- `data`: 送信するバイトデータ（0-255の10進数）

## ビルド方法

```bash
cd /mnt/d/Downloads/bluetoothDesktop
dotnet build
```

## 実行方法

```bash
dotnet run
```

または、ビルド後に生成される実行ファイルを直接実行：

```bash
./bin/Debug/net8.0-windows/BluetoothSerialSender.exe
```

## HC-06のATコマンド設定（オプション）

HC-06の設定を変更する場合は、別途ターミナルソフト（Tera Term等）を使用してATコマンドを送信します：

- ボーレート変更: `AT+BAUD4` (9600bps) ～ `AT+BAUD8` (115200bps)
- デバイス名変更: `AT+NAMEyourname`
- PINコード変更: `AT+PIN1234`

注意：ATコマンドは接続が確立していない状態（LEDが高速点滅）でのみ有効です。
